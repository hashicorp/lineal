{"version":3,"file":"scale.js","sources":["../../src/utils/scale.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2020, 2026\n */\n\nimport { tracked, cached } from '@glimmer/tracking';\nimport * as scales from 'd3-scale';\n\nimport Bounds from './bounds.ts';\nimport CSSRange from './css-range.ts';\n\n// TODO: D3 scales are incredibly fluid, but we can\n// still do a better job locking down these types.\n\n/**\n * All Scales are Ember-friendly wrappers\n * around d3 scales.\n */\nexport interface Scale {\n  /** The bounds of the scale's data space. */\n  domain: any;\n  /** The bounds of the scale's visual space. */\n  range: any;\n  /** The mapper from data space to visual space. */\n  compute: (value: any) => any;\n  /** The underlying D3 Scale instance. */\n  d3Scale: any;\n  /** Whether or not calling scale.compute will result in an error.\n   * `isValid` is `false` when the scale's domain or range are unqualified. */\n  isValid: boolean;\n  /** Creates a new scale of the same type and same properties. The options Config overrides\n   * any set properties (like `Object.assign`). */\n  derive: (options: any) => Scale;\n  /** The default tick values for the scale. These are domain values, not range values. */\n  ticks?: any[];\n}\n\n/**\n * A value set is either an array of numbers (a step-wise representation of a range)\n * or a string (parsed as Bounds range expression).\n */\nexport type ValueSet = number[] | string | Bounds<number>;\n\n/**\n * Continuous scales map a continuous domain to a continuous range (e.g., Linear).\n */\nexport interface ContinuousScaleConfig {\n  /** The bounds of the scale's data space. */\n  domain?: ValueSet;\n  /** The bounds of the scale's visual space. */\n  range?: ValueSet;\n  /** When `true`, values outside the domain are clamped to the min and max of the range\n   * instead of extrapolated beyond the domain's bounds. */\n  clamp?: boolean;\n  /** When `true`, domain bounds are rounded to nice numbers. */\n  nice?: boolean | number;\n}\n\n/**\n * Power scales are continuous scales with the additional property\n * of the exponent.\n */\nexport interface PowScaleConfig extends ContinuousScaleConfig {\n  /** The exponent of the power scale (e.g., 10 results in 10, 100, 1000 while 2 results in 2, 4, 8, 16). */\n  exponent?: number;\n}\n\n/**\n * Logarithmic scales are continuous scales with the addition property\n * of the log base.\n */\nexport interface LogScaleConfig extends ContinuousScaleConfig {\n  /** The base of the log scale (e.g., e results in a natural log while 10 results in the common log). */\n  base?: number;\n}\n\n/**\n * Date scales are like continuous scales, except the domain must be\n * an array of Dates, since Dates have complexity beyond numbers.\n */\nexport interface DateScaleConfig {\n  /** The bounds of the scale's data space. */\n  domain?: Date[] | Bounds<Date>;\n  /** The bounds of the scale's visual space. */\n  range?: ValueSet;\n  /** When `true`, values outside the domain are clamped to the min and max of the range\n   * instead of extrapolated beyond the domain's bounds. */\n  clamp?: boolean;\n  /** When `true`, domain bounds are rounded to nice numbers. */\n  nice?: boolean | number;\n}\n\n/**\n * Diverging scales take a special three-number domain where the first and\n * last element represent the bounds and the middle element represents the\n * neutral base value.\n */\nexport interface DivergingScaleConfig {\n  /** The bounds of the scale's data space. Diverging scales have a three-number domain\n   * representing [max-a, mid, max-b] */\n  domain: [number, number, number];\n  /** An interpolator that maps a value from -1-1 to a value in visual space.. */\n  range: (t: number) => any;\n  /** When `true`, values outside the domain are clamped to the min and max of the range\n   * instead of extrapolated beyond the domain's bounds. */\n  clamp?: boolean;\n\n  exponent?: number;\n  base?: number;\n}\n\n/**\n * Quantize scales map a continuous domain to discrete range.\n */\nexport interface QuantizeScaleConfig {\n  /** The extent of a dataset from which equal intervals are derived using the length\n   * of the provided range to determine the interval count.  */\n  domain?: ValueSet;\n  /** The set of values for the scale's visual space. */\n  range: CSSRange | string[];\n\n  count?: number;\n}\n\n/**\n * Quantile scales map a continuous domain to discrete range.\n */\nexport interface QuantileScaleConfig {\n  /** The complete set of data form which equal frequency quantiles are derived using the\n   * length of the provided range to dermine the interval count and the data itself to\n   * determine interval size. */\n  domain: number[];\n  /** The set of values for the scale's visual space. */\n  range: CSSRange | string[];\n\n  count?: number;\n}\n\n/**\n * Ordinal scales map a discrete domain to a discrete range.\n */\nexport interface OrdinalScaleConfig {\n  /** The discrete set of ordinal (or nominal) input data. */\n  domain?: string[];\n  /** The set of values for the scale's visual space. */\n  range: CSSRange | string[];\n  /** The value to use when a computed value is not in the domain. */\n  unknown?: string;\n}\n\n/**\n * Identity scales always have a domain that is equivalent to its range\n * (i.e., identify function).\n */\nexport interface IdentityScaleConfig {\n  /** The set of values for the scale's visual space and also data space. */\n  range: number | number[];\n}\n\n/**\n * Band scales map a discrete domain to a continuous range. It additionally\n * has padding properties that result in a derived `bandwidth` value that represents\n * the visual space a discrete datum occupies in accordance to the padding properties.\n */\nexport interface BandScaleConfig {\n  /** The discrete set of ordinal (or nominal) input data. */\n  domain?: string[];\n  /** The bounds of the scale's visual space. */\n  range?: ValueSet;\n  /** When `true`, ensures that `step` and `bandwidth` are integers. */\n  round?: boolean;\n  /** A number between 0 and 1 that specifies how the outer padding in the scale's\n   * range is distributed. 0.5 represents centering bands in their range. */\n  align?: number;\n  /** A convenience property for setting `paddingInner` and `paddingOuter` at once. */\n  padding?: number;\n  /** A number between 0 and 1 that specifies how much spacing there is between bands\n   * in proportion to band widths (e.g., when `padding` is 0.5, gaps and bands are\n   * equal widths. */\n  paddingInner?: number;\n  /** A number between 0 and 1 that specifies how much padding is placed on the outside\n   * of bands (while still subtracting available space from the `range`). */\n  paddingOuter?: number;\n}\n\n/**\n * Point scales map a discrete domain to a continuous range. It is a band scale where\n * the derived `bandwidth` is always zero.\n */\nexport interface PointScaleConfig {\n  /** The discrete set of ordinal (or nominal) input data. */\n  domain?: string[];\n  /** The bounds of the scale's visual space. */\n  range?: ValueSet;\n  /** When `true`, ensures that `step` and `bandwidth` are integers. */\n  round?: boolean;\n  /** A number between 0 and 1 that specifies how the outer padding in the scale's\n   * range is distributed. 0.5 represents centering bands in their range. */\n  align?: number;\n  /** A number between 0 and 1 that specifies how much padding is placed on the outside\n   * of the points (while still subtracting available space from the `range`). */\n  padding?: number;\n}\n\nconst boundsFromArg = (arg?: ValueSet): Bounds<number> => {\n  if (arg instanceof Bounds) return arg;\n  return arg ? Bounds.parse(arg) : new Bounds();\n};\n\nabstract class ScaleContinuous implements Scale {\n  /** The bounds of the scale's data space. */\n  @tracked domain: Bounds<number>;\n  /** The bounds of the scale's visual space. */\n  @tracked range: Bounds<number>;\n  /** When `true`, values outside the domain are clamped to the min and max of the range\n   * instead of extrapolated beyond the domain's bounds. */\n  @tracked clamp = false;\n  /** When `true`, domain bounds are rounded to nice numbers. */\n  @tracked nice: boolean | number = false;\n\n  constructor({ domain, range, clamp, nice }: ContinuousScaleConfig = {}) {\n    this.domain = boundsFromArg(domain);\n    this.range = boundsFromArg(range);\n    this.clamp = clamp ?? false;\n    this.nice = nice ?? false;\n  }\n\n  /**\n   * The arguments for constructing a d3Scale instance, derived from the ScaleConfig.\n   */\n  get scaleArgs(): [number[], number[]] {\n    return [this.domain.bounds, this.range.bounds];\n  }\n\n  /**\n   * The d3Scale instance without generic modifications like clamp and nice applied yet.\n   */\n  abstract get _d3Scale(): scales.ScaleContinuousNumeric<number, number>;\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  abstract derive(options: ContinuousScaleConfig): ScaleContinuous;\n\n  /**\n   * The final d3Scale used for computation.\n   */\n  @cached get d3Scale(): scales.ScaleContinuousNumeric<number, number> {\n    const scale = this._d3Scale;\n    if (this.clamp) scale.clamp(true);\n    if (this.nice && typeof this.nice === 'number') {\n      scale.nice(this.nice);\n    } else if (this.nice) {\n      scale.nice();\n    }\n\n    return scale;\n  }\n\n  protected get commonCopyArgs(): ContinuousScaleConfig {\n    return {\n      domain: this.domain.copy(),\n      range: this.range.copy(),\n      clamp: this.clamp,\n      nice: this.nice,\n    };\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: number): number => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Whether or not the Bounds for the domain and range are valid (i.e., have a valid\n   * min and max value).\n   */\n  get isValid(): boolean {\n    return this.domain.isValid && this.range.isValid;\n  }\n\n  /**\n   * The default tick values for the scale. These are domain values, not range values.\n   */\n  get ticks() {\n    return this.d3Scale.ticks();\n  }\n}\n\n/**\n * A scale that maps a domain of values to a range of values on a linear curve.\n */\nexport class ScaleLinear extends ScaleContinuous {\n  get _d3Scale() {\n    return scales.scaleLinear(...this.scaleArgs);\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: ContinuousScaleConfig): ScaleLinear => {\n    return new ScaleLinear(Object.assign(this.commonCopyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of values to a range of values on a power curve.\n */\nexport class ScalePow extends ScaleContinuous {\n  /** The exponent of the power scale (e.g., 10 results in 10, 100, 1000 while 2 results in 2, 4, 8, 16). */\n  @tracked exponent = 1;\n\n  constructor(config: PowScaleConfig) {\n    super(config);\n    this.exponent = config.exponent ?? 1;\n  }\n\n  get _d3Scale() {\n    return scales.scalePow(...this.scaleArgs).exponent(this.exponent);\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: ContinuousScaleConfig): ScalePow => {\n    return new ScalePow(\n      Object.assign(this.commonCopyArgs, { exponent: this.exponent }, options),\n    );\n  };\n}\n\n/**\n * A scale that maps a domain of values to a range of values on a logarithmic curve.\n */\nexport class ScaleLog extends ScaleContinuous {\n  /** The base of the log scale (e.g., e results in a natural log while 10 results in the common log). */\n  @tracked base = 10;\n\n  constructor(config: LogScaleConfig) {\n    super(config);\n    this.base = config.base ?? 10;\n  }\n\n  get _d3Scale() {\n    return scales.scaleLog(...this.scaleArgs).base(this.base);\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: ContinuousScaleConfig): ScaleLog => {\n    return new ScaleLog(\n      Object.assign(this.commonCopyArgs, { base: this.base }, options),\n    );\n  };\n}\n\n/**\n * A scale that maps a domain of values to a range of values on a square root curve.\n */\nexport class ScaleSqrt extends ScaleContinuous {\n  get _d3Scale() {\n    return scales.scaleSqrt(...this.scaleArgs);\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: ContinuousScaleConfig): ScaleSqrt => {\n    return new ScaleSqrt(Object.assign(this.commonCopyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of values to a range of values on a symmetric logarithmic curve.\n */\nexport class ScaleSymlog extends ScaleContinuous {\n  get _d3Scale() {\n    return scales.scaleSymlog(...this.scaleArgs);\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: ContinuousScaleConfig): ScaleSymlog => {\n    return new ScaleSymlog(Object.assign(this.commonCopyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of values to a range of values on a linear curve where the range\n * is internally squared (to encode on area instead of radius).\n */\nexport class ScaleRadial extends ScaleContinuous {\n  get _d3Scale() {\n    return scales.scaleRadial(...this.scaleArgs);\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: ContinuousScaleConfig): ScaleRadial => {\n    return new ScaleRadial(Object.assign(this.commonCopyArgs, options));\n  };\n}\n\nabstract class AbstractScaleTime implements Scale {\n  /** The bounds of the scale's data space. */\n  @tracked domain: Bounds<Date>;\n  /** The bounds of the scale's visual space. */\n  @tracked range: Bounds<number>;\n  /** When `true`, values outside the domain are clamped to the min and max of the range\n   * instead of extrapolated beyond the domain's bounds. */\n  @tracked clamp = false;\n  /** When `true`, domain bounds are rounded to nice numbers. */\n  @tracked nice: boolean | number = false;\n\n  constructor({ domain, range, clamp, nice }: DateScaleConfig = {}) {\n    if (domain instanceof Bounds) {\n      this.domain = domain;\n    } else {\n      this.domain = domain ? new Bounds(domain) : new Bounds();\n    }\n    this.range = boundsFromArg(range);\n    this.clamp = clamp ?? false;\n    this.nice = nice ?? false;\n  }\n\n  /**\n   * The arguments for constructing a d3Scale instance, derived from the `DateScaleConfig`.\n   */\n  get scaleArgs(): [Date[], number[]] {\n    return [this.domain.bounds, this.range.bounds];\n  }\n\n  /**\n   * The d3Scale instance without generic modifications like clamp and nice applied yet.\n   */\n  abstract get _d3Scale(): scales.ScaleTime<number, number>;\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  abstract derive(options: DateScaleConfig): AbstractScaleTime;\n\n  protected get commonCopyArgs(): DateScaleConfig {\n    return {\n      domain: this.domain.copy(),\n      range: this.range.copy(),\n      clamp: this.clamp,\n      nice: this.nice,\n    };\n  }\n\n  /**\n   * The final d3Scale used for computation.\n   */\n  @cached get d3Scale(): scales.ScaleTime<number, number> {\n    const scale = this._d3Scale;\n    if (this.clamp) scale.clamp(true);\n    if (this.nice && typeof this.nice === 'number') {\n      scale.nice(this.nice);\n    } else if (this.nice) {\n      scale.nice();\n    }\n\n    return scale;\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: Date): number => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Whether or not the Bounds for the domain and range are valid (i.e., have a valid\n   * min and max value).\n   */\n  get isValid(): boolean {\n    return this.domain.isValid && this.range.isValid;\n  }\n\n  /**\n   * The default tick values for the scale. These are domain values, not range values.\n   */\n  get ticks() {\n    return this.d3Scale.ticks();\n  }\n}\n\n/**\n * A scale that maps a domain of date values to a range of values on linear curve.\n */\nexport class ScaleTime extends AbstractScaleTime {\n  get _d3Scale() {\n    return scales.scaleTime(...this.scaleArgs);\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: DateScaleConfig): ScaleTime => {\n    return new ScaleTime(Object.assign(this.commonCopyArgs, options));\n  };\n}\n\n/**\n * A `ScaleTime`, except the timezone is UTC instead of local.\n */\nexport class ScaleUtc extends AbstractScaleTime {\n  get _d3Scale() {\n    return scales.scaleUtc(...this.scaleArgs);\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: DateScaleConfig): ScaleTime => {\n    return new ScaleTime(Object.assign(this.commonCopyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of two diverging values and a midpoint to a value between -1 and 1\n * and then passes that number to a range interpolator.\n */\nexport class ScaleDiverging<T> implements Scale {\n  /** The bounds of the scale's data space. Diverging scales have a three-number domain\n   * representing [max-a, mid, max-b] */\n  @tracked domain: [number, number, number];\n  /** An interpolator that maps a value from -1-1 to a value in visual space.. */\n  @tracked range: (t: number) => T;\n  /** When `true`, values outside the domain are clamped to the min and max of the range\n   * instead of extrapolated beyond the domain's bounds. */\n  @tracked clamp = false;\n\n  /** Diverging scales do not support `Bounds` and are therefore always valid. */\n  isValid = true;\n\n  /**\n   * The underlying d3Scale function before setting parameters.\n   */\n  protected scaleFn: (\n    interpolator?: (t: number) => T,\n  ) => scales.ScaleDiverging<any, any> = scales.scaleDiverging;\n\n  constructor({ domain, range, clamp }: DivergingScaleConfig) {\n    this.domain = domain;\n    this.range = range;\n    this.clamp = clamp ?? false;\n  }\n\n  /**\n   * The final d3Scale used for computation.\n   */\n  @cached get d3Scale() {\n    const scale = this.scaleFn(this.range).domain(this.domain);\n    if (this.clamp) scale.clamp(true);\n    return scale;\n  }\n\n  get copyArgs(): DivergingScaleConfig {\n    const [d1, d2, d3] = this.domain;\n    return {\n      domain: [d1, d2, d3],\n      range: this.range,\n      clamp: this.clamp,\n    };\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: number): T => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: DivergingScaleConfig): ScaleDiverging<T> => {\n    return new ScaleDiverging<T>(Object.assign(this.copyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of two diverging values and a midpoint to a value between -1 and 1\n * along a logarithmic curve and then passes that number to a range interpolator.\n */\nexport class ScaleDivergingLog<T> extends ScaleDiverging<T> {\n  @tracked base: number;\n\n  protected scaleFn = scales.scaleDivergingLog;\n\n  constructor(config: DivergingScaleConfig) {\n    super(config);\n    this.base = config.base ?? 1;\n  }\n\n  @cached get d3Scale() {\n    // @ts-expect-error: Bad type upstream\n    const scale = this.scaleFn(this.range).domain(this.domain).base(this.base);\n    if (this.clamp) scale.clamp(true);\n    return scale;\n  }\n\n  get copyArgs(): DivergingScaleConfig {\n    const { base } = this;\n    return Object.assign(super.copyArgs, { base });\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: DivergingScaleConfig): ScaleDivergingLog<T> => {\n    return new ScaleDivergingLog<T>(Object.assign(this.copyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of two diverging values and a midpoint to a value between -1 and 1\n * along a power curve and then passes that number to a range interpolator.\n */\nexport class ScaleDivergingPow<T> extends ScaleDiverging<T> {\n  @tracked exponent: number;\n\n  protected scaleFn = scales.scaleDivergingPow;\n\n  constructor(config: DivergingScaleConfig) {\n    super(config);\n    this.exponent = config.exponent ?? 1;\n  }\n\n  @cached get d3Scale() {\n    const scale = this.scaleFn(this.range)\n      .domain(this.domain)\n      // @ts-expect-error: Bad type upstream\n      .exponent(this.exponent);\n    if (this.clamp) scale.clamp(true);\n    return scale;\n  }\n\n  get copyArgs(): DivergingScaleConfig {\n    const { exponent } = this;\n    return Object.assign(super.copyArgs, { exponent });\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: DivergingScaleConfig): ScaleDivergingPow<T> => {\n    return new ScaleDivergingPow<T>(Object.assign(this.copyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of two diverging values and a midpoint to a value between -1 and 1\n * along a square root curve and then passes that number to a range interpolator.\n */\nexport class ScaleDivergingSqrt<T> extends ScaleDiverging<T> {\n  protected scaleFn = scales.scaleDivergingSqrt;\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: DivergingScaleConfig): ScaleDivergingSqrt<T> => {\n    return new ScaleDivergingSqrt<T>(Object.assign(this.copyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of two diverging values and a midpoint to a value between -1 and 1\n * along a symmetric log curve and then passes that number to a range interpolator.\n */\nexport class ScaleDivergingSymlog<T> extends ScaleDiverging<T> {\n  protected scaleFn = scales.scaleDivergingSymlog;\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: DivergingScaleConfig): ScaleDivergingSymlog<T> => {\n    return new ScaleDivergingSymlog<T>(Object.assign(this.copyArgs, options));\n  };\n}\n\n/**\n * A scale that maps a domain of values to a discrete set of range values, with intervals portioned\n * by the range.\n */\nexport class ScaleQuantize implements Scale {\n  /** The extent of a dataset from which equal intervals are derived using the length\n   * of the provided range to determine the interval count.  */\n  @tracked domain: Bounds<number>;\n  /** The set of values for the scale's visual space. */\n  @tracked range: CSSRange | string[];\n  /** When range is a CSSRange, this becomes the interval count. */\n  @tracked count?: number;\n\n  constructor({ domain, range, count }: QuantizeScaleConfig) {\n    this.domain = boundsFromArg(domain);\n    this.range = range;\n    this.count = count;\n  }\n\n  /** Derived number and string arrays to be used to construct a scale (when the domain is a\n   * {@link bounds.default | Bounds} or the range is a {@link css-range.default | CSSRange}). */\n  get scaleArgs(): [number[], string[]] {\n    const domain: number[] =\n      this.domain instanceof Bounds ? this.domain.bounds : this.domain;\n    const range: string[] =\n      this.range instanceof CSSRange\n        ? this.range.spread(this.count ?? domain.length)\n        : this.range;\n    return [domain, range];\n  }\n\n  /**\n   * The d3Scale used for computation.\n   */\n  @cached get d3Scale() {\n    const [domain, range] = this.scaleArgs;\n    return scales.scaleQuantize(range).domain(domain);\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: number): string => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: QuantizeScaleConfig): ScaleQuantize => {\n    return new ScaleQuantize(\n      Object.assign(\n        {\n          domain: this.domain.copy(),\n          range:\n            this.range instanceof CSSRange\n              ? this.range.copy()\n              : this.range.slice(),\n          count: this.count,\n        },\n        options,\n      ),\n    );\n  };\n\n  /**\n   * Whether or not the Bounds for the domain and range are valid (i.e., have a valid\n   * min and max value).\n   */\n  get isValid(): boolean {\n    return this.domain.isValid;\n  }\n\n  /**\n   * The default tick values for the scale. These are domain values, not range values.\n   */\n  get ticks() {\n    return this.d3Scale.ticks();\n  }\n}\n\n/**\n * A scale that maps a set of values to a discrete set of range values, with intervals portioned\n * by the frequency of values in the dataset.\n */\nexport class ScaleQuantile implements Scale {\n  /** The complete set of data form which equal frequency quantiles are derived using the\n   * length of the provided range to dermine the interval count and the data itself to\n   * determine interval size. */\n  @tracked domain: number[];\n  /** The set of values for the scale's visual space. */\n  @tracked range: CSSRange | string[];\n  /** When range is a CSSRange, this becomes the interval count. */\n  @tracked count?: number;\n\n  /** Quantile scales do not support `Bounds` and are therefore always valid. */\n  isValid = true;\n\n  constructor({ domain, range, count }: QuantileScaleConfig) {\n    this.domain = domain;\n    this.range = range;\n    this.count = count;\n  }\n\n  /**\n   * The d3Scale used for computation.\n   */\n  @cached get d3Scale() {\n    const range: string[] =\n      this.range instanceof CSSRange\n        ? this.range.spread(this.count ?? this.domain.length)\n        : this.range;\n    return scales.scaleQuantile(range).domain(this.domain);\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: number): string => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: QuantileScaleConfig): ScaleQuantile => {\n    return new ScaleQuantile(\n      Object.assign(\n        {\n          domain: this.domain.slice(),\n          range:\n            this.range instanceof CSSRange\n              ? this.range.copy()\n              : this.range.slice(),\n          count: this.count,\n        },\n        options,\n      ),\n    );\n  };\n}\n\n/**\n * A scale that maps a set of values to a discrete set of range values, with intervals portioned\n * by the elements set in the domain.\n */\nexport class ScaleThreshold implements Scale {\n  /** The values that define the bucket points in a dataset. */\n  @tracked domain: number[];\n  /** The set of values for the scale's visual space. */\n  @tracked range: CSSRange | string[];\n\n  /** Threshold scales do not support `Bounds` and are therefore always valid. */\n  isValid = true;\n\n  constructor({ domain, range }: QuantileScaleConfig) {\n    this.domain = domain;\n    this.range = range;\n  }\n\n  /**\n   * The d3Scale used for computation.\n   */\n  @cached get d3Scale() {\n    const range: string[] =\n      this.range instanceof CSSRange\n        ? this.range.spread(this.domain.length + 1)\n        : this.range;\n    return scales.scaleThreshold(range).domain(this.domain);\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: number): string => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: QuantileScaleConfig): ScaleThreshold => {\n    return new ScaleThreshold(\n      Object.assign(\n        {\n          domain: this.domain.slice(),\n          range:\n            this.range instanceof CSSRange\n              ? this.range.copy()\n              : this.range.slice(),\n        },\n        options,\n      ),\n    );\n  };\n}\n\n/**\n * A scale that maps a discrete set of domain values to a discrete set of range values.\n */\nexport class ScaleOrdinal implements Scale {\n  /** The set of values for the scale's data space. */\n  @tracked domain: string[];\n  /** The set of values for the scale's visual space. */\n  @tracked range: CSSRange | string[];\n  /** The value returned for input vaues that are not in the domain. */\n  @tracked unknown: string | undefined;\n\n  /** Threshold scales do not support `Bounds` and are therefore always valid. */\n  isValid = true;\n\n  constructor({ domain, range, unknown }: OrdinalScaleConfig) {\n    this.domain = domain || [];\n    this.range = range;\n    this.unknown = unknown;\n  }\n\n  /**\n   * The d3Scale used for computation.\n   */\n  @cached get d3Scale() {\n    // TODO: Return to instanceof checks when https://github.com/ef4/ember-auto-import/pull/512 is released.\n    const range: string[] =\n      this.range.constructor.name === 'CSSRange' ||\n      this.range instanceof CSSRange\n        ? (this.range as CSSRange).spread(this.domain.length)\n        : this.range;\n    const scale = scales.scaleOrdinal(range).domain(this.domain);\n\n    if (this.unknown != null) {\n      scale.unknown(this.unknown);\n    }\n\n    return scale;\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: string): string => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: OrdinalScaleConfig): ScaleOrdinal => {\n    return new ScaleOrdinal(\n      Object.assign(\n        {\n          domain: this.domain.slice(),\n          range:\n            this.range instanceof CSSRange\n              ? this.range.copy()\n              : this.range.slice(),\n          unknown: this.unknown,\n        },\n        options,\n      ),\n    );\n  };\n}\n\n/**\n * A scale with equivalent domains and ranges (like an identity function).\n */\nexport class ScaleIdentity implements Scale {\n  /** The set of values for both the scale's data space and visual space. */\n  @tracked range: number[];\n\n  /** Identity scales do not support `Bounds` and are therefore always valid. */\n  isValid = true;\n\n  constructor({ range }: IdentityScaleConfig) {\n    this.range = range instanceof Array ? range : [range, range];\n  }\n\n  /**\n   * The d3Scale used for computation.\n   */\n  @cached get d3Scale() {\n    return scales.scaleIdentity(this.range);\n  }\n\n  /** The set of values for the scale's data space. Since the range and domain are always equivalent,\n   * this is here for Scale interface compatability. */\n  @cached get domain() {\n    return this.range;\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: number): number => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: IdentityScaleConfig): ScaleIdentity => {\n    return new ScaleIdentity(\n      Object.assign(\n        {\n          range: this.range.slice(),\n        },\n        options,\n      ),\n    );\n  };\n\n  /**\n   * The default tick values for the scale. These are domain values, not range values.\n   */\n  get ticks() {\n    return this.d3Scale.ticks();\n  }\n}\n\n/**\n * A scale that maps a discrete set of domain values to a continuous range of values by dividing the\n * continuous range into steps that are divided between padding and band widths.\n */\nexport class ScaleBand implements Scale {\n  /** The discrete set of ordinal (or nominal) input data. */\n  @tracked domain: string[];\n  /** The bounds of the scale's visual space. */\n  @tracked range: Bounds<number>;\n  /** When `true`, ensures that `step` and `bandwidth` are integers. */\n  @tracked round = false;\n  /** A number between 0 and 1 that specifies how the outer padding in the scale's\n   * range is distributed. 0.5 represents centering bands in their range. */\n  @tracked align = 0.5;\n  /** A number between 0 and 1 that specifies how much spacing there is between bands\n   * in proportion to band widths (e.g., when `padding` is 0.5, gaps and bands are\n   * equal widths. */\n  @tracked paddingInner = 0;\n  /** A number between 0 and 1 that specifies how much padding is placed on the outside\n   * of bands (while still subtracting available space from the `range`). */\n  @tracked paddingOuter = 0;\n\n  constructor({\n    domain,\n    range,\n    round,\n    align,\n    paddingInner,\n    paddingOuter,\n    padding,\n  }: BandScaleConfig) {\n    this.domain = domain || [];\n    this.range = boundsFromArg(range);\n    this.round = round ?? false;\n    this.align = align ?? 0.5;\n    this.paddingInner = paddingInner ?? padding ?? 0;\n    this.paddingOuter = paddingOuter ?? padding ?? 0;\n  }\n\n  /**\n   * Whether or not the Bounds for the domain and range are valid (i.e., have a valid\n   * min and max value).\n   */\n  get isValid(): boolean {\n    return this.range.isValid;\n  }\n\n  /**\n   * The final d3Scale used for computation.\n   */\n  @cached get d3Scale() {\n    const range: number[] =\n      this.range instanceof Bounds ? this.range.bounds : this.range;\n    return scales\n      .scaleBand(range)\n      .domain(this.domain)\n      .round(this.round)\n      .align(this.align)\n      .paddingInner(this.paddingInner)\n      .paddingOuter(this.paddingOuter);\n  }\n\n  /**\n   * Computes a range value from a domain value.\n   */\n  compute = (value: string): number | undefined => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * The width for a single band within the scale (this represents the width\n   * of a bar in a traditional bar chart).\n   */\n  get bandwidth(): number {\n    return this.d3Scale.bandwidth();\n  }\n\n  /**\n   * The space bewteen two elements in the scale (this represents the width\n   * of a bar + the padding between bars in a traditional bar chart).\n   */\n  get step(): number {\n    return this.d3Scale.step();\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: BandScaleConfig): ScaleBand => {\n    const config: BandScaleConfig = {\n      domain: this.domain.slice(),\n      range: this.range.copy(),\n      align: this.align,\n    };\n\n    if (this.paddingInner === this.paddingOuter) {\n      config.padding = this.paddingInner;\n    } else {\n      config.paddingInner = this.paddingInner;\n      config.paddingOuter = this.paddingOuter;\n    }\n\n    return new ScaleBand(Object.assign(config, options));\n  };\n}\n\n/**\n * A scale that maps a discrete set of domain values to a continuous range of values by dividing the\n * continuous range into steps.\n */\nexport class ScalePoint implements Scale {\n  /** The discrete set of ordinal (or nominal) input data. */\n  @tracked domain: string[];\n  /** The bounds of the scale's visual space. */\n  @tracked range: Bounds<number>;\n  /** When `true`, ensures that `step` and `bandwidth` are integers. */\n  @tracked round = false;\n  /** A number between 0 and 1 that specifies how the outer padding in the scale's\n   * range is distributed. 0.5 represents centering bands in their range. */\n  @tracked align = 0.5;\n  /** A number between 0 and 1 that specifies how much padding is placed on the outside\n   * of the points (while still subtracting available space from the `range`). */\n  @tracked padding = 0;\n\n  constructor({ domain, range, round, align, padding }: PointScaleConfig) {\n    this.domain = domain || [];\n    this.range = boundsFromArg(range);\n    this.round = round ?? false;\n    this.align = align ?? 0.5;\n    this.padding = padding ?? 0;\n  }\n\n  /**\n   * Whether or not the Bounds for the domain and range are valid (i.e., have a valid\n   * min and max value).\n   */\n  get isValid(): boolean {\n    return this.range.isValid;\n  }\n\n  /**\n   * The final d3Scale used for computation.\n   */\n  @cached get d3Scale() {\n    const range: number[] =\n      this.range instanceof Bounds ? this.range.bounds : this.range;\n    return scales\n      .scalePoint(range)\n      .domain(this.domain)\n      .round(this.round)\n      .align(this.align)\n      .padding(this.padding);\n  }\n\n  compute = (value: string): number | undefined => {\n    return this.d3Scale(value);\n  };\n\n  /**\n   * Always returns `0`. It's here for d3 compatability (where point scales are a special form\n   * of band scale).\n   */\n  get bandwidth(): number {\n    // Always returns zero. It's here's for d3 compatability.\n    return this.d3Scale.bandwidth();\n  }\n\n  /**\n   * The space bewteen two elements in the scale (this represents the width\n   * of a bar + the padding between bars in a traditional bar chart).\n   */\n  get step(): number {\n    return this.d3Scale.step();\n  }\n\n  /**\n   * Creates a new scale of the same type and same properties. The options arg overrides\n   * any set properties (like `Object.assign`).\n   */\n  derive = (options: BandScaleConfig): ScaleBand => {\n    return new ScaleBand(\n      Object.assign(\n        {\n          domain: this.domain.slice(),\n          range: this.range.copy(),\n          align: this.align,\n          padding: this.padding,\n        },\n        options,\n      ),\n    );\n  };\n}\n"],"names":["boundsFromArg","arg","Bounds","parse","ScaleContinuous","g","prototype","tracked","i","constructor","domain","range","clamp","nice","scaleArgs","bounds","d3Scale","scale","_d3Scale","n","cached","commonCopyArgs","copy","compute","value","isValid","ticks","ScaleLinear","scales","scaleLinear","derive","options","Object","assign","ScalePow","config","exponent","scalePow","ScaleLog","base","scaleLog","ScaleSqrt","scaleSqrt","ScaleSymlog","scaleSymlog","ScaleRadial","scaleRadial","AbstractScaleTime","ScaleTime","scaleTime","ScaleUtc","scaleUtc","ScaleDiverging","scaleFn","scaleDiverging","copyArgs","d1","d2","d3","ScaleDivergingLog","scaleDivergingLog","ScaleDivergingPow","scaleDivergingPow","ScaleDivergingSqrt","scaleDivergingSqrt","ScaleDivergingSymlog","scaleDivergingSymlog","ScaleQuantize","count","CSSRange","spread","length","scaleQuantize","slice","ScaleQuantile","scaleQuantile","ScaleThreshold","scaleThreshold","ScaleOrdinal","unknown","name","scaleOrdinal","ScaleIdentity","Array","scaleIdentity","ScaleBand","round","align","paddingInner","paddingOuter","padding","scaleBand","bandwidth","step","ScalePoint","scalePoint"],"mappings":"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"}