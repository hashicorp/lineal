{"version":3,"file":"grid-lines.js","sources":["../../src/components/grid-lines.gts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2020, 2026\n */\n\nimport Component from '@glimmer/component';\nimport { cached } from '@glimmer/tracking';\n\nimport type { Scale } from '../utils/scale.ts';\n\n// String literal type for component args\nexport type DirectionType = 'vertical' | 'horizontal';\n\n// Keep enum for backward compatibility\nexport enum Direction {\n  Vertical = 'vertical',\n  Horizontal = 'horizontal',\n}\n\nexport interface GridLinesSignature {\n  Args: {\n    scale: Scale;\n    direction: DirectionType;\n    length: number | string;\n    lineCount?: number;\n    lineValues?: any[];\n    offset?: number;\n  };\n\n  Blocks: {\n    default: [];\n  };\n\n  Element: SVGGElement;\n}\n\nconst DEFAULT_OFFSET =\n  typeof window !== 'undefined' && window.devicePixelRatio > 1 ? 0 : 0.5;\n\nexport default class GridLines extends Component<GridLinesSignature> {\n  @cached\n  get lineValues() {\n    return this.args.lineValues ?? null;\n  }\n\n  @cached\n  get lineCount() {\n    return this.args.lineCount ?? null;\n  }\n\n  @cached\n  get offset() {\n    return this.args.offset ?? DEFAULT_OFFSET;\n  }\n\n  @cached\n  get values() {\n    if (this.lineValues) return this.lineValues;\n\n    const scale = this.args.scale?.d3Scale;\n    if (scale?.ticks) {\n      return this.lineCount != null\n        ? scale.ticks(this.lineCount)\n        : scale.ticks();\n    }\n\n    return scale?.domain();\n  }\n\n  @cached\n  get position() {\n    const copy = this.args.scale.d3Scale.copy();\n    if (copy.bandwidth) {\n      let offset = Math.max(0, copy.bandwidth() - this.offset * 2) / 2;\n      if (copy.round()) offset = Math.round(offset);\n      return (d: number) => +copy(d) + offset;\n    }\n    return (d: number) => +copy(d);\n  }\n\n  @cached\n  get lines() {\n    const length =\n      typeof this.args.length === 'string'\n        ? parseFloat(this.args.length)\n        : this.args.length;\n    const { direction } = this.args;\n    const { offset, position } = this;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-enum-comparison\n    const isHorizontal = direction === Direction.Horizontal;\n\n    return this.values.map((v: any) => ({\n      x1: isHorizontal ? 0 : position(v) + offset,\n      x2: isHorizontal ? length : position(v) + offset,\n      y1: isHorizontal ? position(v) + offset : 0,\n      y2: isHorizontal ? position(v) + offset : length,\n    }));\n  }\n\n  <template>\n    <g class=\"grid-lines\">\n      {{#each this.lines key=\"@index\" as |l|}}\n        <line\n          stroke=\"currentColor\"\n          x1={{l.x1}}\n          x2={{l.x2}}\n          y1={{l.y1}}\n          y2={{l.y2}}\n          ...attributes\n        ></line>\n      {{/each}}\n    </g>\n  </template>\n}\n"],"names":["Direction","DEFAULT_OFFSET","window","devicePixelRatio","GridLines","Component","lineValues","args","n","prototype","cached","lineCount","offset","values","scale","d3Scale","ticks","domain","position","copy","bandwidth","Math","max","round","d","lines","length","parseFloat","direction","isHorizontal","Horizontal","map","v","x1","x2","y1","y2","setComponentTemplate","precompileTemplate","strictMode"],"mappings":"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"}