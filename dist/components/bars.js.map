{"version":3,"file":"bars.js","sources":["../../src/components/bars.gts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2020, 2026\n */\n\nimport Component from '@glimmer/component';\nimport { cached } from '@glimmer/tracking';\n\nimport { Encoding } from '../utils/encoding.ts';\nimport { ScaleLinear } from '../utils/scale.ts';\nimport { qualifyScale, scaleFrom } from '../utils/mark-utils.ts';\nimport { cssFourPropParse } from '../utils/css-four-prop-parse.ts';\nimport { roundedRect } from '../utils/rounded-rect.ts';\n\nimport type { Accessor } from '../utils/encoding.ts';\nimport type { Scale } from '../utils/scale.ts';\n\nexport interface BarsSignature {\n  Args: {\n    data: any[];\n    x: Accessor;\n    y: Accessor;\n    width: Accessor;\n    height: Accessor;\n    xScale?: Scale;\n    yScale?: Scale;\n    widthScale?: Scale;\n    heightScale?: Scale;\n    borderRadius?: string;\n  };\n\n  Blocks: {\n    default: [];\n  };\n\n  Element: SVGRectElement | SVGPathElement;\n}\n\nexport interface BarDatum {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  datum: any;\n  d?: string;\n}\n\nexport default class Bars extends Component<BarsSignature> {\n  @cached\n  get x() {\n    return new Encoding(this.args.x);\n  }\n\n  @cached\n  get y() {\n    return new Encoding(this.args.y);\n  }\n\n  @cached\n  get width() {\n    return new Encoding(this.args.width);\n  }\n\n  @cached\n  get height() {\n    return new Encoding(this.args.height);\n  }\n\n  @cached\n  get xScale() {\n    const scale = scaleFrom(this.args.x, this.args.xScale) || new ScaleLinear();\n    qualifyScale(this, scale, this.x, 'x');\n    return scale;\n  }\n\n  @cached\n  get yScale() {\n    const scale = scaleFrom(this.args.y, this.args.yScale) || new ScaleLinear();\n    qualifyScale(this, scale, this.y, 'y');\n    return scale;\n  }\n\n  @cached\n  get widthScale() {\n    const scale =\n      scaleFrom(this.args.width, this.args.widthScale) || new ScaleLinear();\n    qualifyScale(this, scale, this.width, 'width');\n    return scale;\n  }\n\n  @cached\n  get heightScale() {\n    const scale =\n      scaleFrom(this.args.height, this.args.heightScale) || new ScaleLinear();\n    qualifyScale(this, scale, this.height, 'height');\n    return scale;\n  }\n\n  @cached\n  get borderRadius() {\n    if (this.args.borderRadius) return cssFourPropParse(this.args.borderRadius);\n\n    return undefined;\n  }\n\n  @cached\n  get bars(): BarDatum[] {\n    if (\n      !this.xScale.isValid ||\n      !this.yScale.isValid ||\n      !this.widthScale.isValid ||\n      !this.heightScale.isValid\n    ) {\n      return [];\n    }\n\n    const bars = this.args.data.map((d: any) => {\n      const bar: BarDatum = {\n        x: this.xScale.compute(this.x.accessor(d)),\n        y: this.yScale.compute(this.y.accessor(d)),\n        width: this.widthScale.compute(this.width.accessor(d)),\n        height: this.heightScale.compute(this.height.accessor(d)),\n        datum: d,\n      };\n\n      return bar;\n    });\n\n    const borderRadius = this.borderRadius;\n\n    if (borderRadius) {\n      const radii = {\n        topLeft: borderRadius.top,\n        topRight: borderRadius.right,\n        bottomRight: borderRadius.bottom,\n        bottomLeft: borderRadius.left,\n      };\n\n      bars.forEach((bar) => {\n        bar.d = roundedRect(bar, radii, true);\n      });\n    }\n\n    return bars;\n  }\n\n  <template>\n    {{#each this.bars as |b|}}\n      {{#if b.d}}\n        <path d={{b.d}} ...attributes></path>\n      {{else}}\n        <rect\n          x={{b.x}}\n          y={{b.y}}\n          width={{b.width}}\n          height={{b.height}}\n          ...attributes\n        ></rect>\n      {{/if}}\n    {{/each}}\n  </template>\n}\n"],"names":["Bars","Component","x","Encoding","args","n","prototype","cached","y","width","height","xScale","scale","scaleFrom","ScaleLinear","qualifyScale","yScale","widthScale","heightScale","borderRadius","cssFourPropParse","undefined","bars","isValid","data","map","d","bar","compute","accessor","datum","radii","topLeft","top","topRight","right","bottomRight","bottom","bottomLeft","left","forEach","roundedRect","setComponentTemplate","precompileTemplate","strictMode"],"mappings":"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"}